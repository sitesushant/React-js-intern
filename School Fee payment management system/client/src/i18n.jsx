import { createContext, useContext, useEffect, useMemo, useState } from 'react'

const I18nContext = createContext({ lang: 'en', setLang: () => {}, t: (k) => k })

const DICT = {
  en: {
    dashboard: 'Dashboard',
    students: 'Students',
    payments: 'Payments',
    feeStructure: 'Fee Structure',
    login: 'Login',
    register: 'Register',
    logout: 'Logout',
    language: 'Language',
    emailOrUsername: 'Email or Username',
    password: 'Password',
    signingIn: 'Signing in...',
    noAccount: 'No account?',
    name: 'Name',
    email: 'Email',
    creating: 'Creating...',
    createAccount: 'Create account',
    haveAccount: 'Already have an account?',
    hello: 'Hello',
    totalPaid: 'Total Paid',
    studentDetails: 'Student Details',
    totalFee: 'Total Fee',
    paid: 'Paid',
    pending: 'Pending',
    amountMax: 'Amount (max ₹',
    processing: 'Processing...',
    payNow: 'Pay Now',
    paymentHistory: 'Payment History',
    amount: 'Amount',
    date: 'Date',
    method: 'Method',
    reference: 'Reference',
    receipt: 'Receipt',
    paymentSuccess: 'Payment Successful',
    great: 'Great!',
    paidOn: 'Paid',
    on: 'on',
    feeReceipt: 'Fee Receipt',
    receiptNo: 'Receipt No',
    student: 'Student',
    class: 'Class',
    thanks: 'Thank you for your payment.',
    printReceipt: 'Print Receipt',
    addStudent: 'Add Student',
    studentsList: 'Students List',
    selectClass: 'Select Class',
    rollNo: 'Roll No.',
    username: 'Username',
    passcode: 'Passcode',
    actions: 'Actions',
    loading: 'Loading...',
    add: 'Add',
    edit: 'Edit',
    delete: 'Delete',
    doPayment: 'Do a Payment (Cash or Other)',
    cashPayments: 'Cash Payments',
    onlinePayments: 'Online Payments',
    time: 'Time',
    selectStudent: 'Select Student',
    currentStructure: 'Current Structure',
    addClassFee: 'Add Class & Fee',
    currentExtraCharges: 'Current Extra Charges',
    id: 'ID',
    totalExpected: 'Total Expected',
    totalCollected: 'Total Collected',
    totalRemaining: 'Total Remaining',
    perStudent: 'Per Student',
    goToPayments: 'Go to Payments',
    myDashboard: 'My Dashboard',
  },
  ne: {
    dashboard: 'ड्यासबोर्ड',
    students: 'विद्यार्थी',
    payments: 'भुक्तानी',
    feeStructure: 'शुल्क संरचना',
    login: 'लगइन',
    register: 'दर्ता',
    logout: 'लगआउट',
    language: 'भाषा',
    emailOrUsername: 'इमेल वा प्रयोगकर्ता नाम',
    password: 'पासवर्ड',
    signingIn: 'साइन इन हुँदै...',
    noAccount: 'खाता छैन?',
    name: 'नाम',
    email: 'इमेल',
    creating: 'बनाइँदै...',
    createAccount: 'खाता बनाउनुहोस्',
    haveAccount: 'खाता छ?',
    hello: 'नमस्ते',
    totalPaid: 'जम्मा भुक्तानी',
    studentDetails: 'विद्यार्थी विवरण',
    totalFee: 'जम्मा शुल्क',
    paid: 'भुक्तानी',
    pending: 'बाकी',
    amountMax: 'रकम (अधिकतम ₹',
    processing: 'प्रक्रिया हुँदै...',
    payNow: 'अहिले तिर्नुहोस्',
    paymentHistory: 'भुक्तानी इतिहास',
    amount: 'रकम',
    date: 'मिति',
    method: 'विधि',
    reference: 'सन्दर्भ',
    receipt: 'रसिद',
    paymentSuccess: 'भुक्तानी सफल',
    great: 'राम्रो!',
    paidOn: 'तिरियो',
    on: 'मा',
    feeReceipt: 'शुल्क रसिद',
    receiptNo: 'रसिद नं',
    student: 'विद्यार्थी',
    class: 'कक्षा',
    thanks: 'तपाईंको भुक्तानीको लागि धन्यवाद।',
    printReceipt: 'रसिद छाप्नुहोस्',
    addStudent: 'विद्यार्थी थप्नुहोस्',
    studentsList: 'विद्यार्थी सूची',
    selectClass: 'कक्षा छान्नुहोस्',
    rollNo: 'रोल नं.',
    username: 'प्रयोगकर्ता नाम',
    passcode: 'पासकोड',
    actions: 'क्रिया',
    loading: 'लोड हुँदै...',
    add: 'थप्नुहोस्',
    edit: 'सम्पादन',
    delete: 'हटाउनुहोस्',
    doPayment: 'भुक्तानी गर्नुहोस् (नगद वा अन्य)',
    cashPayments: 'नगद भुक्तानी',
    onlinePayments: 'अनलाइन भुक्तानी',
    time: 'समय',
    selectStudent: 'विद्यार्थी छान्नुहोस्',
    currentStructure: 'हालको संरचना',
    addClassFee: 'कक्षा र शुल्क थप्नुहोस्',
    currentExtraCharges: 'हालका अतिरिक्त शुल्क',
    id: 'पहिचान',
    totalExpected: 'कुल अपेक्षित',
    totalCollected: 'कुल सङ्कलित',
    totalRemaining: 'कुल बाँकी',
    perStudent: 'प्रति विद्यार्थी',
    goToPayments: 'भुक्तानीमा जानुहोस्',
    myDashboard: 'मेरो ड्यासबोर्ड',
  }
}

export const I18nProvider = ({ children }) => {
  const [lang, setLang] = useState(() => {
    try { return localStorage.getItem('lang') || 'en' } catch { return 'en' }
  })
  useEffect(() => { try { localStorage.setItem('lang', lang) } catch {} }, [lang])
  const value = useMemo(() => ({
    lang,
    setLang,
    t: (key) => (DICT[lang] && DICT[lang][key]) || (DICT.en[key] || key)
  }), [lang])
  return <I18nContext.Provider value={value}>{children}</I18nContext.Provider>
}

export const useI18n = () => useContext(I18nContext)


